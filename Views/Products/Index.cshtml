@model IEnumerable<retail_app_tester.Models.Product>

@{
    ViewData["Title"] = "Products";
}

<div class="container">
    <div class="row mb-5">
        <div class="col-12">
            <div class="d-flex justify-content-between align-items-center">
                <div>
                    <h1 class="display-5 fw-bold" style="color: var(--dark-brown);">Our Products</h1>
                    <p class="lead" style="color: var(--medium-brown);">Discover our complete skincare collection</p>
                </div>
                <a asp-action="Create" class="btn btn-primary" style="background-color: var(--terracotta); border-color: var(--terracotta)>
                    <i class="fas fa-plus-circle me-1"></i> Add New Product
                </a>

                
            </div>
        </div>
    </div>

    <div class="row mb-4">
        <div class="col-md-8">
            <div class="search-box">
                <i class="fas fa-search"></i>
                <input type="text" class="form-control" placeholder="Search products...">
            </div>
        </div>
        <div class="col-md-4">
            <select class="form-select" style="border-radius: 20px; border: 1px solid var(--beige);">
                <option>All Categories</option>
                <option>Cleansers</option>
                <option>Moisturizers</option>
                <option>Serums</option>
                <option>Sunscreens</option>
                <option>Masks</option>
            </select>
        </div>
    </div>

    <!-- Product Grid -->
    @if (Model.Any())
    {
        <div class="row row-cols-1 row-cols-md-2 row-cols-xl-4 g-4">
            @foreach (var item in Model)
            {
                <div class="col">
                    <div class="product-card">
                        <div class="position-relative">
                            <div class="image-container">
                                @if (!string.IsNullOrEmpty(item.ImageURL))
                                {
                                    <img src="@item.ImageURL" class="product-image" alt="@item.ProductName">
                                }
                                else
                                {
                                    <img src="https://via.placeholder.com/300x200/f8f7f4/5b4f47?text=No+Image" class="product-image" alt="No image available">
                                }
                            </div>
                            @if (item.StockQuantity > 0)
                            {
                                <span class="stock-badge bg-success">In Stock</span>
                            }
                            else
                            {
                                <span class="stock-badge bg-danger">Out of Stock</span>
                            }
                        </div>
                        <div class="card-body">
                            <div class="product-brand">@item.Brand</div>
                            <h5 class="product-name">@item.ProductName</h5>
                            <div class="product-size">@item.Size</div>
                            <div class="product-price">R @item.PriceRand,@(item.PriceCents.ToString("00"))</div>
                            <div class="button-container d-grid gap-2">
                                <form asp-controller="Orders" asp-action="AddProductToOrder" method="post">
                                    <input type="hidden" name="productRowKey" value="@item.RowKey" />
                                    <input type="hidden" name="quantity" value="1" />
                                    <button type="submit" class="btn btn-add-to-cart" @(item.StockQuantity == 0 ? "disabled" : "")>
                                        <i class="fas fa-shopping-cart me-1"></i> Add to Cart
                                    </button>
                                </form>
                                <a asp-action="Details" asp-route-id="@item.RowKey" class="btn btn-view-details">
                                    <i class="fas fa-info-circle me-1"></i> View Details
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            }
        </div>
    }
    else
    {
        <div class="no-products text-center py-5">
            <i class="fas fa-box-open fa-3x mb-3" style="color: var(--beige);"></i>
            <h3 style="color: var(--medium-brown);">No Products Found</h3>
            <p style="color: var(--medium-brown);">Get started by adding your first product!</p>
            <a asp-action="Create" class="btn btn-primary mt-2">
                <i class="fas fa-plus-circle me-1"></i> Add Your First Product
            </a>
        </div>
    }
</div>

<style>
    /* Product Card Styles */
    .product-card {
        background: white;
        border-radius: 12px;
        overflow: hidden;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        border: none;
        height: 100%;
        box-shadow: var(--card-shadow);
        display: flex;
        flex-direction: column;
    }

        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 25px rgba(67, 56, 49, 0.2);
        }

    .image-container {
        height: 200px;
        overflow: hidden;
        display: flex;
        align-items: center;
        justify-content: center;
        background-color: var(--off-white);
    }

    .product-image {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .product-brand {
        color: var(--terracotta);
        font-weight: 600;
        font-size: 0.85rem;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        margin-bottom: 8px;
    }

    .product-name {
        font-weight: 700;
        color: var(--dark-brown);
        line-height: 1.3;
        overflow: hidden;
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        min-height: 2.6em;
        margin-bottom: 10px;
    }

    .product-size {
        color: var(--medium-brown);
        font-size: 0.9rem;
        margin-bottom: 12px;
    }

    .product-price {
        font-weight: 800;
        color: var(--terracotta);
        font-size: 1.25rem;
        margin-bottom: 15px;
    }

    .stock-badge {
        position: absolute;
        top: 15px;
        right: 15px;
        font-size: 0.75rem;
        padding: 5px 10px;
        border-radius: 20px;
        z-index: 1;
    }

    .btn-add-to-cart {
        background-color: var(--terracotta);
        border: none;
        color: white;
        font-weight: 600;
        padding: 10px 15px;
        border-radius: 8px;
        transition: all 0.2s;
        width: 100%;
    }

        .btn-add-to-cart:hover {
            background-color: var(--light-brown);
            color: white;
            transform: translateY(-2px);
        }

        .btn-add-to-cart:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
            transform: none;
        }

    .btn-view-details {
        background-color: var(--off-white);
        color: var(--dark-brown);
        font-weight: 600;
        padding: 10px 15px;
        border-radius: 8px;
        transition: all 0.2s;
        width: 100%;
        text-decoration: none;
        display: block;
        text-align: center;
        border: 1px solid #e8e4e0;
    }

        .btn-view-details:hover {
            background-color: var(--beige);
            color: var(--dark-brown);
            transform: translateY(-2px);
        }

    .card-body {
        display: flex;
        flex-direction: column;
        flex-grow: 1;
        padding: 20px;
    }

    .button-container {
        margin-top: auto;
        padding-top: 15px;
    }

    /* Search box */
    .search-box {
        position: relative;
    }

        .search-box input {
            border-radius: 20px;
            padding-left: 40px;
            border: 1px solid var(--beige);
            background-color: var(--off-white);
        }

        .search-box i {
            position: absolute;
            left: 15px;
            top: 12px;
            color: var(--medium-brown);
        }

    /* No products state */
    .no-products {
        text-align: center;
        padding: 60px 40px;
        color: var(--medium-brown);
        background-color: var(--off-white);
        border-radius: 12px;
    }
</style>
